<html>
  <head>
    <script src='https://code.jquery.com/jquery-2.1.1.min.js'></script>
  </head>
  
  <body>
    <form name='reader-form'>
      <legend>New Reader Testing Form</legend>
      
      <input name='parent' placeholder='Parent ID'>
      <br>
      <input name='first_name' placeholder='First Name'>
      <br>
      <input name='last_name' placeholder='Last Name'>
      <br>
      <input type='radio' name='gender' value='male'>Male<br>
      <input type='radio' name='gender' value='female'>Female
      <br>
      <input name='age' placeholder='Age'>
      <br>
      <input name='grade' placeholder='Grade'>
      <br>
      <input name='about_me' placeholder='About Me'>
      <br>
      <button type='submit'>Submit</button>
    </form>
    
    <h3>Listing all Readers</h3>
    <ul id='reader-list'></ul>
    
    <script>
      function appendToList(readers) {
        var list = [];
        readers.forEach(function(reader) {
          var html = '<li><a href="/readers/' + reader._id + '">' + reader.first_name + ' ' + reader.last_name;
          list.push(html);
        });
        $('#reader-list').append(list);
      }
      
      $(function() {
        $.get('/readers', function(json) {
          appendToList(json.readers);
        });
        
        $('form[name="reader-form"]').on('submit', function(event) {
          event.preventDefault();
          var form = $(this);
          
          var data = form.serialize();
          console.log(data);
          $.ajax({
            type: 'POST',
            url: '/readers',
            data: data
          })
          .done(function(reader) {
            alert('Successfully added reader\n' + reader);
            appendToList([reader]);
            form.trigger('reset');
          })
          .fail(function(err) {
            console.log(err);
          });
        });
      });
    </script>
  </body>
  
</html>